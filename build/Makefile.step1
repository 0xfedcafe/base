# -*- makefile -*-

default: all

include build/Makefile.config

%.ml: %.mll $(OCAMLLEX)
	$(OCAMLLEX) $<

bootstrap/src/base_int63_backend.ml: bootstrap/src/select-int63-backend.c $(OCAMLC)
	$(OCAMLC) -ccopt -E -c $< | grep '^"OUT:[^"]*"$$' | sed 's/"OUT:\([^"]*\)"/\1/' > $@

all: $(GENERATED_FILES)
	$(OCAML) build/gen_rules.ml > build/Makefile.rules
	$(MAKE) -f build/Makefile.step2
